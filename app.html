---
layout: none
title: PGN Viewer
pgn: |
  [Event "Demo Game"]
  [Site "Istanbul"]
  [Date "2025.12.16"]
  [Round "-"]
  [White "White Player"]
  [Black "Black Player"]
  [Result "1-0"]

  1. e4 e5 2. Nf3 Nc6
---
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>{{ page.title }}</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.12.0/chess.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/chessboard-js/1.0.0/chessboard-1.0.0.min.js"></script>
<link rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/chessboard-js/1.0.0/chessboard-1.0.0.min.css">

<style>
* { box-sizing: border-box; }

html, body {
  margin: 0;
  height: 100%;
  background: #0f1115;
  color: #e6e6e6;
  font-family: system-ui, -apple-system, sans-serif;
}

/* ---------- TOP BAR ---------- */
.topbar {
  min-height: 52px;
  padding: 0 14px;
  display: flex;
  align-items: center;
  gap: 10px;
  background: #171a21;
  border-bottom: 1px solid #222;
}

.brand {
  display: flex;
  align-items: center;
  gap: 10px;
}

.brand img {
  width: 22px;
  height: 22px;
  filter: invert(1);
}

.title {
  font-weight: 700;
}

/* ---------- LAYOUT ---------- */
.app {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}

.main {
  flex: 1;
  display: flex;
  flex-direction: column;
}

/* ---------- BOARD ---------- */
.board-wrap {
  padding: 12px;
}

#board {
  width: min(92vw, 560px);
  margin: 0 auto;
}

/* ---------- CONTROLS ---------- */
.controls {
  padding: 0 12px 12px;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.controls-row {
  display: flex;
  gap: 6px;
}

.controls button {
  flex: 1;
  padding: 10px 0;
  border: none;
  border-radius: 10px;
  background: #1f2430;
  color: #ddd;
  font-size: 16px;
}

/* ---------- MOVES ---------- */
.moves {
  padding: 16px;
  overflow-y: auto;
  line-height: 2.2;
  font-size: 18px;
  border-top: 1px solid #222;
}

.move {
  cursor: pointer;
  padding: 2px 6px;
  border-radius: 6px;
  display: inline-block;
}

.move.active {
  background: #3a7afe;
  color: #fff;
}

/* ---------- DESKTOP ---------- */
@media (min-width: 900px) {
  .main {
    display: grid;
    grid-template-columns: 560px 1fr;
  }
  .moves {
    border-top: none;
    border-left: 1px solid #222;
  }
}
</style>
</head>

<body>

<div class="app">

  <div class="topbar">
    <div class="brand">
      <img src="https://jekyllchess.github.io/assets/favicon.png" alt="">
      <div class="title">JekyllChess PGN App</div>
    </div>
  </div>

  <div class="main">
    <div>
      <div class="board-wrap">
        <div id="board"></div>
      </div>

      <div class="controls">
        <div class="controls-row">
          <button id="btnFlip">↺ Flip</button>
          <button id="btnReset">Reset</button>
        </div>
      </div>
    </div>

    <div class="moves" id="moves"></div>
  </div>
</div>

<script id="pgn-data" type="application/json">
{{ page.pgn | jsonify }}
</script>

<script>
(() => {
  const FIG = { K:"♔", Q:"♕", R:"♖", B:"♗", N:"♘" };
  const movesDiv = document.getElementById("moves");

  const chess = new Chess();

  /* Load PGN if provided */
  const pgnEl = document.getElementById("pgn-data");
  if (pgnEl && pgnEl.textContent.trim()) {
    chess.load_pgn(JSON.parse(pgnEl.textContent), { sloppy: true });
  }

  const board = Chessboard("board", {
    position: chess.fen(),
    draggable: true,
    pieceTheme: "https://chessboardjs.com/img/chesspieces/wikipedia/{piece}.png",
    onDrop: onDrop
  });

  function sanToFig(san) {
    let s = san.replace(/^[KQRBN]/, p => FIG[p]);
    s = s.replace(/=([QRBN])/g, (_,p)=>"="+FIG[p]);
    return s;
  }

  function renderMoves() {
    movesDiv.innerHTML = "";
    chess.history({ verbose: true }).forEach((m, i) => {
      const span = document.createElement("span");
      span.className = "move";
      const num = m.color === "w" ? `${Math.floor(i/2)+1}. ` : "";
      span.textContent = num + sanToFig(m.san) + " ";
      span.onclick = () => gotoMove(i);
      movesDiv.appendChild(span);
    });
  }

  function gotoMove(i) {
    chess.reset();
    const hist = chess.history({ verbose: true });
    for (let j = 0; j <= i; j++) chess.move(hist[j]);
    board.position(chess.fen(), true);
    highlight(i);
  }

  function highlight(i) {
    [...document.querySelectorAll(".move")]
      .forEach((m,k)=>m.classList.toggle("active", k===i));
  }

  function onDrop(from, to) {
    const move = chess.move({ from, to, promotion: "q" });
    if (!move) return "snapback";
    renderMoves();
    highlight(chess.history().length - 1);
  }

  document.getElementById("btnFlip").onclick = () =>
    board.orientation(board.orientation() === "white" ? "black" : "white");

  document.getElementById("btnReset").onclick = () => {
    chess.reset();
    board.position("start", true);
    renderMoves();
  };

  renderMoves();
})();
</script>

</body>
</html>
